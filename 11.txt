# Code to generate all 20 features for fraud detection

# Risk-weighted transaction hour feature
df['risk_trxn_hour'] = df['hct_mer_mcc_baysian_risk'] * df['trxn_hour']

# Risk-weighted weekend feature
df['risk_trxn_weekend'] = df['hct_term_state_baysian_risk'] * df['trxn_wkend_ind']

# Risk-weighted foreign indicator feature
df['risk_foreign_ind'] = df['hct_term_country_code_baysian_risk'] * df['foreign_ind']

# Risk-weighted transaction utility feature
df['risk_tran_util'] = df['hct_mer_mcc_baysian_risk'] * df['tran_util']

# Risk-weighted gift card indicator feature
df['risk_gift_card'] = df['hct_mer_mcc_baysian_risk'] * df['gift_card_ind']

# Risk-weighted even-dollar indicator feature
df['risk_even_dollar'] = df['hct_term_country_code_baysian_risk'] * df['even_dollar_ind']

# Risk-weighted customer present feature
df['risk_cust_present'] = df['hct_term_state_baysian_risk'] * df['cust_present_ind']

# Risk-weighted CVV mismatch feature
df['risk_cvv_mismatch'] = df['ucm_avs_resp_baysian_risk'] * df['cvv2_mismatch_ind']

# Risk-weighted AVS complete mismatch feature
df['risk_avs_complete_mismatch'] = df['ucm_avs_resp_baysian_risk'] * df['avs_complete_mismatch_ind']

# Risk-weighted time since last transaction feature
df['risk_time_since_last_transaction'] = df['hct_term_state_baysian_risk'] / (df['time_since_last_trxn'] + 1)

# Risk-weighted same amount bursts feature
df['risk_same_amount_bursts'] = df['hct_mer_mcc_baysian_risk'] * df['cnt_same_amt_2hr']

# Risk-weighted combined CVV and AVS mismatch feature
df['risk_cvv_avs_combo_mismatch'] = (
    df['hct_term_country_code_baysian_risk'] * 
    (df['cvv2_mismatch_ind'] + df['avs_mismatch_ind'])
)

# Risk-weighted zero authorization feature
df['risk_zero_auth_anomalies'] = df['hct_mer_mcc_baysian_risk'] * df['zero_auth_ind']

# Risk-weighted geographic repeats feature
df['risk_high_risk_geographic_repeats'] = df['hct_term_state_baysian_risk'] * df['cnt_same_pos_amt_24hr']

# Risk-weighted cross-country fraud feature
df['risk_cross_country_fraud'] = (
    df['hct_term_country_code_baysian_risk'] + df['hct_term_state_baysian_risk']
) * df['foreign_ind']

# Risk-weighted authorization behavior feature
df['risk_auth_behavior_anomalies'] = (
    (df['auth_ecom_ind'] + df['auth_ecom_1'] + df['auth_ecom_2']) * 
    (df['hct_mer_mcc_baysian_risk'] + df['hct_term_state_baysian_risk'])
)

# Risk-weighted recurrence behavior feature
df['risk_recurrence_behavior'] = (
    df['hct_mer_mcc_baysian_risk'] * 
    (df['token_recur_bill_ind'] + df['recur_bill_ind'])
)

# Risk-weighted total amount in 24 hours feature
df['risk_total_amount_24hr'] = df['hct_mer_mcc_baysian_risk'] * df['tot_amt_cnt_24hr']

# Risk-weighted swipe activity feature
df['risk_frequent_swipe_activities'] = df['hct_term_state_baysian_risk'] * df['avg_swipe_amt_24hr']

# Risk-weighted clustered behavior feature
df['risk_clustered_behavior'] = (
    df['hct_mer_mcc_baysian_risk'] * 
    (df['cnt_same_amt_6hr'] + df['cnt_same_pos_24hr'])
)
